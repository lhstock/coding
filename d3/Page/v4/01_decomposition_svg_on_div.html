<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>Try_d3_v4</title>
	</head>
	<script src="../../library/d3_v4.js"></script>
	<script src="../../library/jquery.min.js"></script>

	<body>

	</body>
	<script>
		console.log("d3-v4!!!");
		var color = d3.schemeCategory10;
		
		var dom_chart = d3.select("body").append("div").attr("id", "chart")

		dom_chart.style("display", "flex")
			.style("height", "40vw")
			.style("width", "100vw")
			.style("flex-direction", "column")

		dom_chart.append("h1")
			.style("text-align", "center")
			.text("一个简单的图表")

		dom_chart.append("div")
			.style("flex", 1)
			.style("display", "flex")
			.style("flex-direction", "row")

		dom_chart.select("div")

		var dom_plot = dom_chart.select("div")
			.append("svg")
			.attr("id", "plot-area")
			.style("flex", 1)
			.style("background",color[0])

		var dom_y_axis = dom_chart.select("div")
			.append("svg")
			.attr("id", "y-axis")
			.style("width", "5rem")

		var dom_x_axis = dom_chart.append("div")
			.style("height", "3rem")
			.style("display", "flex")
			.style("flex-direction", "row")
			.append("svg")
			.attr("id", "x-axis")
			.style("flex", 1)
			.style("margin-right", "5rem")
		
		var x_scale = d3.scaleLinear()
			.domain([1,100000]);
		
		var xAxis = d3.axisBottom(x_scale);
		
		var xAxisContainer = d3.select("#x-axis");
		
		var y_scale = d3.scaleLinear()
			.domain([10000,0]);
		
		var yAxis = d3.axisRight(y_scale);
		var yAxisContainer = d3.select("#y-axis");
		
		function render() {
			console.log(xAxisContainer.property("clientWidth"));
		    x_scale.range([0,xAxisContainer.property("clientWidth")]);
		    y_scale.range([0,yAxisContainer.property("clientHeight")]);

		    console.log("获取xAxisContainer宽度",xAxisContainer.property("clientWidth"));
		    console.log("在xAisContainer中渲染xAix");
		    xAxisContainer.call(xAxis)
		    yAxisContainer.call(yAxis)//.selectAll("text").style("font-size","1rem")
		    console.log("渲染后xAxisContainer宽度",xAxisContainer.property("clientWidth"));
		}
		render();
		
		window.onresize = function () {
		    render()
		}
	</script>

</html>